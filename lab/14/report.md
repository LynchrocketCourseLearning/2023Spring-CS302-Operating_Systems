# OS lab14 Report
name：刘乐奇

sid：12011327

## 1. 手册第二部分中的 inode，如果 block_size 是 4KB，指针大小是 4B，一个 inode 能管理的最大文件大小是多少，写出计算过程。

由题意可知，一个 block 中可存储 $\frac{4KB}{4B}=2^{10}$ 个指针。

一个 iNode 里有 12 个直接指针和 3 个间接指针（一级、二级、三级），那么一个 iNode 能管理的最大文件大小是：

$$
4KB×(12+2^{10}+2^{10}×2^{10}+2^{10}×2^{10}×2^{10}) \\
=48KB+4MB+4GB+4TB
$$

## 2. SFS中的 inode 可以管理的最大文件大小是多少，写出计算过程。

最大时 sfs_disk_inode 里的索引全部指向文件。默认 ucore 里 SFS_NDIRECT 是 12，即直接索引的数据页大小为 
$12×4KB=48KB$。而间接索引所指向的 block 有 $\frac{4KB}{4B}=2^{10}$ 个指针，一共会指向 $2^{10}\times 4KB=4MB$ 大小的空间。所以 iNode 可以管理的最大文件大小是 $48KB+4MB$

## 3. SFS中 sfs_disk_inode 和 sfs_disk_entry 的关系是什么。
对于普通文件，索引值指向的 block 中保存的是文件中的数据。而对于目录，索引值指向的数据保存的是目录下的文件项，每个文件项占一个 block，文件项内存储了指向文件 iNode 的索引值以及文件名。

也就是说，如果 sfs_disk_inode 表示的是文件，那么它的索引都会指向最终指向文件数据；而如果 sfs_disk_inode 表示的是目录，那么它的索引会指向 sfs_disk_entry 用以存储其下文件 iNode 的索引值以及文件名。